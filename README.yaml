name: "aws-datadog-lambda-forwarder"
# Canonical GitHub repo
github_repo: "cloudposse-terraform-components/aws-datadog-lambda-forwarder"
# Short description of this project
description: |-
  This component provisions all infrastructure required to deploy
  [Datadog Lambda forwarders](https://github.com/DataDog/datadog-serverless-functions/tree/master/aws/logs_monitoring).
  It depends on the `datadog-configuration` component to obtain the Datadog API keys.

  ## Sponsorship

  <picture>
    <source media="(prefers-color-scheme: dark)" srcset="https://cloudposse.com/images/partners/datadog-white.svg">
    <source media="(prefers-color-scheme: light)" srcset="https://cloudposse.com/images/partners/datadog-purple.svg">
    <img alt="Datadog" src="https://cloudposse.com/images/partners/datadog-purple.svg" align="right" width="40%">
  </picture>


  This project is supported by the [Datadog Open Source Program](https://www.datadoghq.com/partner/open-source/).

  As part of this collaboration, Datadog provides a dedicated sandbox account that we use for automated integration and acceptance testing. This contribution allows us to continuously validate changes against a real Datadog environment, improving reliability and reducing the risk of regressions.

  We are grateful to Datadog for supporting our open source ecosystem and helping ensure that infrastructure code for Terraform remains stable and well-tested
  ___

usage: |-
  **Stack Level**: Regional

  Here's an example snippet for how to use this component:

  ```yaml
  components:
    terraform:
      datadog-lambda-forwarder:
        settings:
          spacelift:
            workspace_enabled: true
        vars:
          enabled: true
          name: datadog-lambda-forwarder
          # Set `forwarder_rds_enabled`  to `true` and configure `rds-enhanced-monitoring` Log Group when:
          # 1. The account has RDS instances provisioned
          # 2. RDS Enhanced Monitoring is enabled
          # 3. CloudWatch Log Group `RDSOSMetrics` exists (it will be created by AWS automatically when RDS Enhanced Monitoring is enabled)
          forwarder_rds_enabled: true
          forwarder_log_enabled: true
          forwarder_vpc_logs_enabled: true
          cloudwatch_forwarder_log_groups:
            rds-enhanced-monitoring:
              name: "RDSOSMetrics"
              filter_pattern: ""
            eks-cluster:
              # Use either `name` or `name_prefix` with `name_suffix`
              # If `name_prefix` with `name_suffix` are used, the final `name` will be constructed using `name_prefix` + context + `name_suffix`,
              # e.g. "/aws/eks/eg-ue2-prod-eks-cluster/cluster"
              name_prefix: "/aws/eks/"
              name_suffix: "eks-cluster/cluster"
              filter_pattern: ""
            transfer-sftp:
              name: "/aws/transfer/s-xxxxxxxxxxxx"
              filter_pattern: ""
  ```

  Note for other regions: you need to deploy the `datadog-configuration` component in the respective region â€” the Datadog
  configuration is moving to a regional implementation.

  For example, if you usually deploy to `us-west-2` (and DD Configuration is `gbl`), deploy it to the new region and then
  deploy the lambda forwarder.

  ```yaml
  import:
    - orgs/acme/plat/dev/_defaults
    - mixins/region/us-east-1
    - catalog/datadog/configuration
    - catalog/datadog/lambda-forwarder

  components:
    terraform:
      datadog-configuration:
        vars:
          datadog_secrets_store_type: SSM
          datadog_secrets_source_store_account_stage: auto
          datadog_secrets_source_store_account_region: "us-west-2"

      datadog-lambda-forwarder:
        vars:
          datadog_configuration_environment: "use1"
  ```

references:
  - name: "Datadog's documentation about provisioning keys"
    description: ""
    url: "https://docs.datadoghq.com/account_management/api-app-keys"
  - name: cloudposse-terraform-components
    url: https://github.com/orgs/cloudposse-terraform-components/repositories
    description: "Cloud Posse's upstream component"
tags:
  - component/datadog-lambda-forwarder
  - layer/datadog
  - provider/aws
  - provider/datadog
# Categories of this project
categories:
  - component/datadog-lambda-forwarder
  - layer/datadog
  - provider/aws
  - provider/datadog
# License of this project
license: "APACHE2"
# Badges to display
badges:
  - name: Latest Release
    image: https://img.shields.io/github/release/cloudposse-terraform-components/aws-datadog-lambda-forwarder.svg?style=for-the-badge
    url: https://github.com/cloudposse-terraform-components/aws-datadog-lambda-forwarder/releases/latest
  - name: Slack Community
    image: https://slack.cloudposse.com/for-the-badge.svg
    url: https://slack.cloudposse.com
related:
  - name: "Cloud Posse Terraform Modules"
    description: Our collection of reusable Terraform modules used by our reference architectures.
    url: "https://docs.cloudposse.com/modules/"
  - name: "Atmos"
    description: "Atmos is like docker-compose but for your infrastructure"
    url: "https://atmos.tools"
contributors: [] # If included generates contribs
